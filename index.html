<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=yes">
  <title>Bijoy Mazumder ¬∑ Mohor Financial Fitness</title>
  <!-- SheetJS for Excel -->
  <script src="https://cdn.sheetjs.com/xlsx-0.20.2/package/dist/xlsx.full.min.js"></script>
  <style>
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body { font-family: 'Segoe UI', Roboto, system-ui, sans-serif; background: #f0f4fa; padding: 12px 12px 30px; display: flex; flex-direction: column; align-items: center; }
    .app-container { max-width: 600px; width: 100%; }
    .company-header { text-align: center; margin: 5px 0 10px; }
    .company-name { font-size: 1.7rem; font-weight: 700; color: #063970; background: linear-gradient(145deg, #ffffff, #e6edf6); padding: 16px 12px; border-radius: 50px; box-shadow: 0 6px 12px rgba(0,40,70,0.08); border: 1px solid rgba(46,91,136,0.2); }
    h2 { font-size: 1.7rem; font-weight: 600; text-align: center; margin: 0.5rem 0 0.8rem; color: #0a2f4d; }
    .section { background: white; padding: 20px 18px; border-radius: 30px; margin-bottom: 20px; box-shadow: 0 6px 18px rgba(0,30,60,0.05); border: 1px solid #d2e2f2; }
    .section h3 { font-size: 1.4rem; font-weight: 600; margin-bottom: 18px; color: #113355; border-left: 6px solid #2b6c9e; padding-left: 16px; }
    label { font-weight: 500; font-size: 1rem; color: #1e3a5f; display: block; margin-bottom: 4px; margin-top: 14px; }
    input, select { width: 100%; padding: 16px 18px; font-size: 1.1rem; border: 1.5px solid #d9e2ef; border-radius: 26px; background: #fafcff; margin-bottom: 6px; appearance: none; font-family: inherit; }
    select { background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="%23333" stroke-width="2"><polyline points="6 9 12 15 18 9"/></svg>'); background-repeat: no-repeat; background-position: right 18px center; background-size: 18px; }
    .calc-btn-container { margin: 10px 0 30px; }
    .primary-btn { background: #1d4d7c; color: white; border: none; padding: 20px 16px; font-size: 1.5rem; font-weight: 700; border-radius: 60px; width: 100%; box-shadow: 0 8px 0 #0b2a44, 0 8px 24px rgba(0,60,120,0.3); transition: 0.05s linear; cursor: pointer; }
    .primary-btn:active { transform: translateY(6px); box-shadow: 0 2px 0 #0b2a44, 0 10px 20px rgba(0,60,120,0.2); }
    .action-row { display: flex; flex-wrap: wrap; gap: 12px; margin-top: 20px; justify-content: center; }
    .action-btn { flex: 1 1 200px; background: white; border: 2px solid #1d4d7c; color: #1d4d7c; font-size: 1.2rem; font-weight: 600; padding: 14px 8px; border-radius: 50px; background: #f0f7ff; cursor: pointer; }
    .action-btn:active { background: #d6e8ff; }
    .result { background: #ffffff; border-radius: 32px; padding: 24px 18px; margin: 15px 0 20px; border: 1px solid #c4d8f0; }
    .result p { font-size: 1.1rem; padding: 6px 0; border-bottom: 1px dashed #c0d3e8; }
    .result hr { margin: 16px 0; border: 1px solid #d6e5f5; }
    .interpret-box { background: #e5effb; border-radius: 24px; padding: 16px; margin: 15px 0; }
    .interpret-box table { width: 100%; border-collapse: collapse; }
    .interpret-box td { padding: 6px 8px; border-bottom: 1px solid #b0c8dd; }
    .answer-list { margin: 15px 0; }
    .answer-item { display: flex; justify-content: space-between; padding: 8px 0; border-bottom: 1px solid #e2ecf9; }
    .status { margin-top: 10px; font-size: 0.9rem; color: #2b4f6e; text-align: center; }
    /* ‡¶≤‡ßÅ‡¶ï‡¶æ‡¶®‡ßã ‡¶ó‡¶ø‡¶ü‡¶π‡¶æ‡¶¨ ‡¶∏‡ßá‡¶ü‡¶ø‡¶Ç‡¶∏ */
    .hidden-settings { display: none; }
  </style>
</head>
<body>
<div class="app-container">
  <div class="company-header">
    <div class="company-name">Bijoy Mazumder . Mohor Savings & Insurance Services</div>
  </div>
  <h2>Financial Fitness Assessment</h2>

  <!-- ‡¶ó‡¶ø‡¶ü‡¶π‡¶æ‡¶¨ ‡¶∏‡ßá‡¶ü‡¶ø‡¶Ç‡¶∏ - ‡¶∏‡¶Æ‡ßç‡¶™‡ßÇ‡¶∞‡ßç‡¶£ ‡¶≤‡ßÅ‡¶ï‡¶æ‡¶®‡ßã, ‡¶ï‡¶ø‡¶®‡ßç‡¶§‡ßÅ ‡¶Æ‡¶æ‡¶® ‡¶Ü‡¶ó‡ßá ‡¶•‡ßá‡¶ï‡ßá ‡¶∏‡ßá‡¶ü ‡¶ï‡¶∞‡¶æ -->
  <div class="hidden-settings">
    <input type="text" id="repoOwner" value="biplabhait1978"> <!-- ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ GitHub ‡¶á‡¶â‡¶ú‡¶æ‡¶∞‡¶®‡ßá‡¶Æ ‡¶¶‡¶ø‡¶® -->
    <input type="text" id="repoName" value="bijoy"> <!-- ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶∞‡¶ø‡¶™‡ßã‡¶ú‡¶ø‡¶ü‡¶∞‡¶ø‡¶∞ ‡¶®‡¶æ‡¶Æ ‡¶¶‡¶ø‡¶® -->
    <input type="text" id="jsonPath" value="assessments.json"> <!-- JSON ‡¶´‡¶æ‡¶á‡¶≤‡ßá‡¶∞ ‡¶™‡¶æ‡¶• -->
    <input type="password" id="githubToken" value="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"> <!-- ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶ü‡ßã‡¶ï‡ßá‡¶® ‡¶¶‡¶ø‡¶® -->
  </div>

  <div id="reportArea">
    <!-- ‡¶ï‡ßç‡¶≤‡¶æ‡¶Ø‡¶º‡ßá‡¶®‡ßç‡¶ü ‡¶§‡¶•‡ßç‡¶Ø -->
    <div class="section">
      <h3>Client Information</h3>
      <label>Client Name</label>
      <input type="text" id="clientName" placeholder="Full name">
      <label>Address</label>
      <input type="text" id="clientAddress" placeholder="City / street">
      <label>Mobile Number</label>
      <input type="tel" id="clientMobile" placeholder="+91 98765 43210">
    </div>

    <!-- ‡ßß‡ß¶‡¶ü‡¶ø ‡¶™‡ßç‡¶∞‡¶∂‡ßç‡¶® -->
    <div class="section">
      <h3>Assessment Questions</h3>
      <div id="questions"></div>
    </div>

    <!-- ‡¶ñ‡¶∞‡¶ö ‡¶ì ‡¶Ü‡¶Ø‡¶º -->
    <div class="section">
      <h3>Expenditure / Income Ratio</h3>
      <label>Monthly Family Expenditure (‚Çπ)</label>
      <input type="number" id="monthlyExp" placeholder="e.g. 25000" min="0" step="1000">
      <label>Monthly Family Income (‚Çπ)</label>
      <input type="number" id="monthlyInc" placeholder="e.g. 50000" min="0" step="1000">
      <p style="font-size:1rem; margin-top:8px; color:#2b4f6e;">Expenditure √∑ Income √ó 100 = %</p>
    </div>

    <!-- ‡¶â‡¶™‡¶¶‡ßá‡¶∑‡ßç‡¶ü‡¶æ‡¶∞ ‡¶¨‡¶ø‡¶¨‡¶∞‡¶£ -->
    <div class="section">
      <h3>Advisor Details</h3>
      <label>Advisor Name</label>
      <input type="text" id="advisorName" placeholder="Your name">
      <label>Advisor Mobile</label>
      <input type="tel" id="advisorMobile" placeholder="+91 98765 43210">
    </div>

    <!-- ‡¶ï‡ßç‡¶Ø‡¶æ‡¶≤‡¶ï‡ßÅ‡¶≤‡ßá‡¶ü ‡¶¨‡¶æ‡¶ü‡¶® -->
    <div class="calc-btn-container">
      <button class="primary-btn" onclick="calculateAndSaveToGitHub()">üìä Calculate Score & Save</button>
    </div>

    <!-- ‡¶∞‡ßá‡¶ú‡¶æ‡¶≤‡ßç‡¶ü ‡¶¶‡ßá‡¶ñ‡¶æ‡¶®‡ßã‡¶∞ ‡¶ú‡¶æ‡ßü‡¶ó‡¶æ -->
    <div class="result" id="result"></div>

    <!-- ‡¶∏‡ßç‡¶ü‡ßç‡¶Ø‡¶æ‡¶ü‡¶æ‡¶∏ ‡¶Æ‡ßá‡¶∏‡ßá‡¶ú -->
    <div id="githubStatus" class="status"></div>
  </div>

  <!-- Excel ‡¶°‡¶æ‡¶â‡¶®‡¶≤‡ßã‡¶° ‡¶¨‡¶æ‡¶ü‡¶® (‡¶∂‡ßÅ‡¶ß‡ßÅ ‡¶è‡¶ü‡¶ø ‡¶•‡¶æ‡¶ï‡¶¨‡ßá, PDF ‡¶®‡ßá‡¶á) -->
  <div class="action-row">
    <button class="action-btn" onclick="exportFromGitHubToExcel()">üì• Download Excel </button>
  </div>
</div>

<script>
  // ----- ‡¶á‡¶Ç‡¶∞‡ßá‡¶ú‡¶ø ‡¶™‡ßç‡¶∞‡¶∂‡ßç‡¶® (‡¶™‡¶ø‡¶°‡¶ø‡¶è‡¶´ ‡¶Ö‡¶®‡ßÅ‡¶Ø‡¶æ‡ßü‡ßÄ) -----
  const questions = [
    "Do you have life insurance equal to 10 times your annual income?",
    "Do you know how much money you will need monthly after retirement?",
    "Have you calculated the cost of your child‚Äôs education and marriage?",
    "Do you have at least 25 lakh health insurance cover?",
    "If something happens to you, will your loans be fully paid?",
    "Can your family manage expenses for 6 months without income?",
    "Do you invest regularly for your future goals?",
    "Are you confident your current investments will meet future needs?",
    "Do you have an emergency fund for 6 months of expenses?",
    "Do you have a written financial plan with a professional advisor?"
  ];

  // ‡¶™‡ßç‡¶∞‡¶∂‡ßç‡¶®‡¶ó‡ßÅ‡¶≤‡ßã ‡¶∞‡ßá‡¶®‡ßç‡¶°‡¶æ‡¶∞
  const container = document.getElementById("questions");
  questions.forEach((q, index) => {
    container.innerHTML += `
      <label id="qlabel${index}">${index+1}. ${q}</label>
      <select id="q${index}">
        <option value="">Select</option>
        <option value="1">Yes</option>
        <option value="0">No</option>
      </select>
    `;
  });

  // GitHub-‡¶è JSON ‡¶´‡¶æ‡¶á‡¶≤ ‡¶Ü‡¶™‡¶°‡ßá‡¶ü ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶´‡¶æ‡¶Ç‡¶∂‡¶®
  async function saveToGitHub(data) {
    const token = document.getElementById('githubToken').value.trim();
    const owner = document.getElementById('repoOwner').value.trim();
    const repo = document.getElementById('repoName').value.trim();
    const path = document.getElementById('jsonPath').value.trim();

    if (!token || !owner || !repo || !path) {
      alert('GitHub ‡¶∏‡ßá‡¶ü‡¶ø‡¶Ç‡¶∏ ‡¶∏‡¶†‡¶ø‡¶ï‡¶≠‡¶æ‡¶¨‡ßá ‡¶¶‡ßá‡¶ì‡ßü‡¶æ ‡¶π‡ßü‡¶®‡¶ø‡•§');
      return false;
    }

    const apiUrl = `https://api.github.com/repos/${owner}/${repo}/contents/${path}`;
    const statusDiv = document.getElementById('githubStatus');
    statusDiv.innerText = 'GitHub-‡¶è ‡¶∏‡¶Ç‡¶∞‡¶ï‡ßç‡¶∑‡¶£ ‡¶ï‡¶∞‡¶æ ‡¶π‡¶ö‡ßç‡¶õ‡ßá...';

    try {
      // ‡¶™‡ßç‡¶∞‡¶•‡¶Æ‡ßá ‡¶´‡¶æ‡¶á‡¶≤‡ßá‡¶∞ existing content (SHA ‡¶∏‡¶π) ‡¶™‡¶æ‡¶ì‡ßü‡¶æ‡¶∞ ‡¶ö‡ßá‡¶∑‡ßç‡¶ü‡¶æ
      let sha = null;
      let existingData = [];
      const getResponse = await fetch(apiUrl, {
        headers: { 'Authorization': `token ${token}` }
      });

      if (getResponse.status === 200) {
        const fileInfo = await getResponse.json();
        sha = fileInfo.sha;
        // content base64 ‡¶°‡¶ø‡¶ï‡ßã‡¶°
        const content = atob(fileInfo.content);
        existingData = JSON.parse(content);
      } else if (getResponse.status === 404) {
        // ‡¶´‡¶æ‡¶á‡¶≤ ‡¶®‡ßá‡¶á, ‡¶®‡¶§‡ßÅ‡¶® ‡¶§‡ßà‡¶∞‡¶ø ‡¶π‡¶¨‡ßá
        existingData = [];
      } else {
        const err = await getResponse.json();
        throw new Error(err.message || 'GitHub ‡¶•‡ßá‡¶ï‡ßá ‡¶°‡¶æ‡¶ü‡¶æ ‡¶™‡¶æ‡¶ì‡ßü‡¶æ ‡¶Ø‡¶æ‡ßü‡¶®‡¶ø');
      }

      // ‡¶®‡¶§‡ßÅ‡¶® ‡¶°‡¶æ‡¶ü‡¶æ ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶∞‡ßá‡¶§‡ßá ‡¶Ø‡ßã‡¶ó
      existingData.push(data);

      // JSON ‡¶Ü‡¶™‡¶°‡ßá‡¶ü
      const updatedContent = btoa(JSON.stringify(existingData, null, 2));

      const putBody = {
        message: `Add assessment from ${data.clientName} on ${new Date().toLocaleString()}`,
        content: updatedContent,
        branch: 'main'
      };
      if (sha) putBody.sha = sha;

      const putResponse = await fetch(apiUrl, {
        method: 'PUT',
        headers: {
          'Authorization': `token ${token}`,
          'Content-Type': 'application/json'
        },
        body: JSON.stringify(putBody)
      });

      if (putResponse.ok) {
        statusDiv.innerText = '‚úÖ GitHub-‡¶è ‡¶∏‡¶´‡¶≤‡¶≠‡¶æ‡¶¨‡ßá ‡¶∏‡¶Ç‡¶∞‡¶ï‡ßç‡¶∑‡¶ø‡¶§!';
        return true;
      } else {
        const err = await putResponse.json();
        throw new Error(err.message);
      }
    } catch (error) {
      statusDiv.innerText = '‚ùå ‡¶§‡ßç‡¶∞‡ßÅ‡¶ü‡¶ø: ' + error.message;
      console.error(error);
      return false;
    }
  }

  // ‡¶ï‡ßç‡¶Ø‡¶æ‡¶≤‡¶ï‡ßÅ‡¶≤‡ßá‡¶ü ‡¶ì GitHub-‡¶è ‡¶∏‡ßá‡¶≠
  async function calculateAndSaveToGitHub() {
    // ‡¶™‡ßç‡¶∞‡¶•‡¶Æ‡ßá ‡¶∞‡ßá‡¶ú‡¶æ‡¶≤‡ßç‡¶ü ‡¶ï‡ßç‡¶Ø‡¶æ‡¶≤‡¶ï‡ßÅ‡¶≤‡ßá‡¶ü ‡¶ï‡¶∞‡ßá ‡¶°‡¶æ‡¶ü‡¶æ ‡¶§‡ßà‡¶∞‡¶ø
    let answers = [];
    let total = 0;
    for (let i = 0; i < questions.length; i++) {
      let select = document.getElementById("q" + i);
      let val = select.value;
      let answerText = "";
      if (val === "1") { answerText = "Yes"; total += 1; }
      else if (val === "0") { answerText = "No"; }
      else { answerText = "Not selected"; }
      answers.push({ question: `Q${i+1}`, answer: answerText });
    }

    let exp = parseFloat(document.getElementById("monthlyExp").value) || 0;
    let inc = parseFloat(document.getElementById("monthlyInc").value) || 0;
    let ratio = (inc > 0) ? (exp / inc) * 100 : 0;
    let ratioFixed = ratio.toFixed(1);

    let ratioLevel = "";
    if (ratio <= 45) ratioLevel = "Excellent Financial Position";
    else if (ratio <= 50) ratioLevel = "Good, Minor Improvement Needed";
    else if (ratio <= 65) ratioLevel = "Moderate Risk, Strategic Correction Needed";
    else ratioLevel = "High Risk, Immediate Planning Required";

    const clientNameField = document.getElementById("clientName").value || "(not provided)";
    const clientAddrField = document.getElementById("clientAddress").value || "(not provided)";
    const clientMobileField = document.getElementById("clientMobile").value || "(not provided)";
    const advisorNameField = document.getElementById("advisorName").value || "(not provided)";
    const advisorMobileField = document.getElementById("advisorMobile").value || "(not provided)";

    let risk = "";
    if (total >= 8) risk = "Low Risk";
    else if (total >= 5) risk = "Moderate Risk";
    else risk = "High Risk";

    // ‡¶∞‡ßá‡¶ú‡¶æ‡¶≤‡ßç‡¶ü HTML ‡¶¶‡ßá‡¶ñ‡¶æ‡¶®‡ßã
    let answersHtml = '<div class="answer-list"><h4>üìã Detailed Answers</h4>';
    for (let i = 0; i < questions.length; i++) {
      let qText = document.getElementById(`qlabel${i}`).innerText;
      answersHtml += `<div class="answer-item"><span>${qText}</span> <strong>${answers[i].answer}</strong></div>`;
    }
    answersHtml += '</div>';
    document.getElementById("result").innerHTML = `
      <h3 style="color:#063970;">üë§ ${clientNameField}</h3>
      <p>üìç ${clientAddrField}</p>
      <p>üìû ${clientMobileField}</p>
      <hr>
      <p style="font-size:1.4rem; font-weight:700;">‚úÖ Checklist score: ${total}/10 (${(total/10)*100}%)</p>
      ${answersHtml}
      <div class="interpret-box">
        <p style="font-size:1.3rem; font-weight:600;">üìä Expenditure/Income Ratio</p>
        <p>Expenditure: ‚Çπ${exp.toFixed(0)} | Income: ‚Çπ${inc.toFixed(0)}</p>
        <p style="font-size:1.5rem;">${ratioFixed}%</p>
        <p><strong>Interpretation: ${ratioLevel}</strong></p>
      </div>
      <hr>
      <p><b>Advisor:</b> ${advisorNameField}</p>
      <p><b>Advisor Mobile:</b> ${advisorMobileField}</p>
    `;

    // GitHub-‡¶è ‡¶∏‡¶Ç‡¶∞‡¶ï‡ßç‡¶∑‡¶£‡ßá‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶°‡¶æ‡¶ü‡¶æ ‡¶™‡ßç‡¶∞‡¶∏‡ßç‡¶§‡ßÅ‡¶§
    const assessmentData = {
      timestamp: new Date().toISOString(),
      clientName: clientNameField,
      address: clientAddrField,
      mobile: clientMobileField,
      total: total,
      risk: risk,
      ratio: ratioFixed,
      ratioLevel: ratioLevel,
      advisorName: advisorNameField,
      advisorMobile: advisorMobileField,
      answers: answers
    };

    await saveToGitHub(assessmentData);
  }

  // GitHub ‡¶•‡ßá‡¶ï‡ßá JSON ‡¶°‡¶æ‡¶ü‡¶æ ‡¶®‡¶ø‡¶Ø‡¶º‡ßá Excel ‡¶¨‡¶æ‡¶®‡¶æ‡¶®‡ßã
  async function exportFromGitHubToExcel() {
    const token = document.getElementById('githubToken').value.trim();
    const owner = document.getElementById('repoOwner').value.trim();
    const repo = document.getElementById('repoName').value.trim();
    const path = document.getElementById('jsonPath').value.trim();

    if (!token || !owner || !repo || !path) {
      alert('GitHub ‡¶∏‡ßá‡¶ü‡¶ø‡¶Ç‡¶∏ ‡¶∏‡¶†‡¶ø‡¶ï‡¶≠‡¶æ‡¶¨‡ßá ‡¶¶‡ßá‡¶ì‡ßü‡¶æ ‡¶π‡ßü‡¶®‡¶ø‡•§');
      return;
    }

    const apiUrl = `https://api.github.com/repos/${owner}/${repo}/contents/${path}`;
    const statusDiv = document.getElementById('githubStatus');
    statusDiv.innerText = 'GitHub ‡¶•‡ßá‡¶ï‡ßá ‡¶°‡¶æ‡¶ü‡¶æ ‡¶Ü‡¶®‡¶æ ‡¶π‡¶ö‡ßç‡¶õ‡ßá...';

    try {
      const response = await fetch(apiUrl, {
        headers: { 'Authorization': `token ${token}` }
      });

      if (response.status === 404) {
        alert('GitHub-‡¶è ‡¶è‡¶ñ‡¶®‡ßã ‡¶ï‡ßã‡¶®‡ßã ‡¶°‡¶æ‡¶ü‡¶æ ‡¶®‡ßá‡¶á‡•§ ‡¶™‡ßç‡¶∞‡¶•‡¶Æ‡ßá ‡¶ï‡¶ø‡¶õ‡ßÅ ‡¶è‡¶®‡ßç‡¶ü‡ßç‡¶∞‡¶ø ‡¶∏‡¶Ç‡¶∞‡¶ï‡ßç‡¶∑‡¶£ ‡¶ï‡¶∞‡ßÅ‡¶®‡•§');
        statusDiv.innerText = '‚ùå ‡¶´‡¶æ‡¶á‡¶≤ ‡¶™‡¶æ‡¶ì‡ßü‡¶æ ‡¶Ø‡¶æ‡ßü‡¶®‡¶ø';
        return;
      }
      if (!response.ok) {
        const err = await response.json();
        throw new Error(err.message);
      }

      const fileInfo = await response.json();
      const content = atob(fileInfo.content);
      const assessments = JSON.parse(content);

      if (!assessments || assessments.length === 0) {
        alert('‡¶ï‡ßã‡¶®‡ßã ‡¶°‡¶æ‡¶ü‡¶æ ‡¶®‡ßá‡¶á‡•§');
        statusDiv.innerText = '‚ö†Ô∏è ‡¶°‡¶æ‡¶ü‡¶æ ‡¶ñ‡¶æ‡¶≤‡¶ø';
        return;
      }

      // Excel-‡¶è‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶°‡¶æ‡¶ü‡¶æ ‡¶´‡¶∞‡¶Æ‡ßç‡¶Ø‡¶æ‡¶ü
      const dataForExcel = assessments.map(entry => ({
        '‡¶§‡¶æ‡¶∞‡¶ø‡¶ñ': new Date(entry.timestamp).toLocaleDateString('bn-BD'),
        '‡¶ï‡ßç‡¶≤‡¶æ‡¶Ø‡¶º‡ßá‡¶®‡ßç‡¶ü‡ßá‡¶∞ ‡¶®‡¶æ‡¶Æ': entry.clientName,
        '‡¶Æ‡ßã‡¶¨‡¶æ‡¶á‡¶≤': entry.mobile,
        '‡¶∏‡ßç‡¶ï‡ßã‡¶∞': `${entry.total}/10`,
        '‡¶∞‡¶ø‡¶∏‡ßç‡¶ï ‡¶≤‡ßá‡¶≠‡ßá‡¶≤': entry.risk,
        '‡¶ñ‡¶∞‡¶ö-‡¶Ü‡¶Ø‡¶º ‡¶Ö‡¶®‡ßÅ‡¶™‡¶æ‡¶§ (%)': entry.ratio,
        '‡¶Ö‡ßç‡¶Ø‡¶æ‡¶°‡¶≠‡¶æ‡¶á‡¶ú‡¶æ‡¶∞': entry.advisorName,
        '‡¶Ö‡ßç‡¶Ø‡¶æ‡¶°‡¶≠‡¶æ‡¶á‡¶ú‡¶æ‡¶∞ ‡¶Æ‡ßã‡¶¨‡¶æ‡¶á‡¶≤': entry.advisorMobile
      }));

      const worksheet = XLSX.utils.json_to_sheet(dataForExcel);
      const workbook = XLSX.utils.book_new();
      XLSX.utils.book_append_sheet(workbook, worksheet, 'Assessments');
      XLSX.writeFile(workbook, 'GitHub_Financial_History.xlsx');

      statusDiv.innerText = '‚úÖ Excel ‡¶°‡¶æ‡¶â‡¶®‡¶≤‡ßã‡¶° ‡¶∏‡¶Æ‡ßç‡¶™‡¶®‡ßç‡¶®!';
    } catch (error) {
      statusDiv.innerText = '‚ùå ‡¶§‡ßç‡¶∞‡ßÅ‡¶ü‡¶ø: ' + error.message;
      console.error(error);
    }
  }
</script>
</body>
</html>
